package steps;

import java.util.Locale;

import com.github.javafaker.Faker;

import io.cucumber.java.en.Given;
import io.cucumber.java.en.Then;
import io.cucumber.java.en.When;
import io.restassured.response.Response;
import org.junit.Assert;
import service.UsersService;
import utils.Utils;

public class UsersSteps {
	
	Faker faker = new Faker(new Locale("pt-BR"));
	
	UsersService users = new UsersService();
	
	Utils utils = new Utils();
	
	Response response;
	
	String body;
	
	String name;
	
	String job;
	
	@Given("que tenha preenchido as informacoes de cadastro")
	public void que_tenha_preenchido_as_informacoes_de_cadastro() {
		
		name = faker.name().fullName();
		
		job = faker.job().title();
		
		body = users.body(name, job);
		
	}
		
	@Then("deve retornar as informacoes de cadastro")
	public void deve_retornar_as_informacoes_de_cadastro() {
	    
		Assert.assertEquals(201, response.statusCode());
		
		Assert.assertEquals(name, response.jsonPath().getString("name"));
		
		Assert.assertEquals(job, response.jsonPath().getString("job"));
		
		Assert.assertEquals(utils.data(), response.jsonPath().getString("createdAt").substring(0, 10));
		
	}
	
	io.cucumber.junit.UndefinedStepException: The step 'que tenha preenchido as informacoes de cadastro nem nome' and 1 other step(s) are undefined.
	You can implement these steps using the snippet(s) below:

	@Given("que tenha preenchido as informacoes de cadastro nem nome")
	public void que_tenha_preenchido_as_informacoes_de_cadastro_nem_nome() {
	    // Write code here that turns the phrase above into concrete actions
	    throw new io.cucumber.java.PendingException();
	}
	@Then("deve retornar erro de nome invalido")
	public void deve_retornar_erro_de_nome_invalido() {
	    // Write code here that turns the phrase above into concrete actions
	    throw new io.cucumber.java.PendingException();
	}




	@When("cadastrar usuario")
	public void cadastrar_usuario() {
	    
		response = users.postUsers(body);
		
	}


}
