package steps.users;

import java.util.Locale;

import com.github.javafaker.Faker;

import io.cucumber.java.en.Given;
import io.cucumber.java.en.Then;
import io.cucumber.java.en.When;
import io.restassured.response.Response;
import service.users.UsersServices;

import org.junit.Assert;

import utils.Utils;

public class UsersSteps {
	
	Faker faker = new Faker(new Locale("pt-BR"));
	
	UsersServices users = new UsersServices();
	
	Utils utils = new Utils();
	
	Response response;
	
	String body;
	
	String name;
	
	String job;
	
	String mensagem;
	
	@Given("que tenha preenchido as informacoes de cadastro")
	public void que_tenha_preenchido_as_informacoes_de_cadastro() {
		
		name = faker.name().fullName();
		
		job = faker.job().title();
		
		body = users.body(name, job);
		
	}
		
	@Then("deve retornar as informacoes de cadastro")
	public void deve_retornar_as_informacoes_de_cadastro() {
	    
		Assert.assertEquals(201, response.statusCode());
		
		Assert.assertEquals(name, response.jsonPath().getString("name"));
		
		Assert.assertEquals(job, response.jsonPath().getString("job"));
		
		Assert.assertEquals(utils.data(), response.jsonPath().getString("createdAt").substring(0, 10));
		
	}
	
	@Given("que tenha preenchido as informacoes de cadastro sem nome")
	public void que_tenha_preenchido_as_informacoes_de_cadastro_sem_nome() {
	    
		name = "";
		
		job = faker.job().title();
		
		body = users.body(name, job);
		
		mensagem = "Nome inv√°lido";
		
	}
	
	@Then("deve retornar erro de nome invalido")
	public void deve_retornar_erro_de_nome_invalido() {
	    
		Assert.assertEquals(422, response.statusCode());
		
		Assert.assertEquals(mensagem, response.jsonPath().getString("message"));
		
	}

	@When("cadastrar usuario")
	public void cadastrar_usuario() {
	    
		response = users.postUsers(body);
		
	}
	
	io.cucumber.junit.UndefinedStepException: The step 'consultar usuarios' and 1 other step(s) are undefined.
	You can implement these steps using the snippet(s) below:

	@When("consultar usuarios")
	public void consultar_usuarios() {
	    // Write code here that turns the phrase above into concrete actions
	    throw new io.cucumber.java.PendingException();
	}
	@Then("deve retornar lista de usuarios")
	public void deve_retornar_lista_de_usuarios() {
	    // Write code here that turns the phrase above into concrete actions
	    throw new io.cucumber.java.PendingException();
	}





}
